<p style="color: green"><%= notice %></p>

<% content_for :title, "Visits" %>

<h1>Visits</h1>

<% @visits.each do |visit| %>
  <% if can?(:read, Visit) %>
  <tr>
    <td>Nome:
    <%= visit.visitor.name %>  
    </td>
    <td>Setor:
    <%= visit.sector.name %>  
    </td>
    <td>Funcionário:
    <%= visit.employee.name %>  
    </td>
    <td>Horário:
    <%= visit.visit_time %>  
    </td>
    <td>
      <% if visit.confirmed_at.present? %>
        ✅ Confirmada em <%= visit.confirmed_at.strftime("%d/%m/%Y %H:%M") %>
      <% elsif can?(:confirm, visit) %>
        <%= button_to "Confirmar Visita", confirm_visit_path(visit), method: :patch, class: "btn btn-success" %>
      <% else %>
        ⏳ Pendente
      <% end %>
    </td>
  </tr>
  <% end %>
  <% if can?(:update, Visit) %>
    <p>
      <%= link_to "Show this visit", visit %>
    </p>
  <% end %>
<% end %>
<% if can?(:create, Visit) %>
  <%= link_to "New visit", new_visit_path %>
<% end %>
